!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).Embeddable=n()}(this,(function(){"use strict";function e(){}function n(e){return e()}function t(){return Object.create(null)}function o(e){e.forEach(n)}function r(e){return"function"==typeof e}function i(e,n){return e!=e?n==n:e!==n||e&&"object"==typeof e||"function"==typeof e}function s(e,n){e.appendChild(n)}function a(e,n,t){e.insertBefore(n,t||null)}function c(e){e.parentNode.removeChild(e)}function l(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function u(){return d("")}function p(e,n,t){null==t?e.removeAttribute(n):e.getAttribute(n)!==t&&e.setAttribute(n,t)}function f(e,n,t){e.classList[t?"add":"remove"](n)}let h;function m(e){h=e}function g(){if(!h)throw new Error("Function called outside component initialization");return h}function _(){const e=g();return(n,t)=>{const o=e.$$.callbacks[n];if(o){const r=function(e,n){const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,n),t}(n,t);o.slice().forEach((n=>{n.call(e,r)}))}}}const w=[],b=[],y=[],v=[],$=Promise.resolve();let k=!1;function x(e){y.push(e)}let E=!1;const j=new Set;function M(){if(!E){E=!0;do{for(let e=0;e<w.length;e+=1){const n=w[e];m(n),N(n.$$)}for(m(null),w.length=0;b.length;)b.pop()();for(let e=0;e<y.length;e+=1){const n=y[e];j.has(n)||(j.add(n),n())}y.length=0}while(w.length);for(;v.length;)v.pop()();k=!1,E=!1,j.clear()}}function N(e){if(null!==e.fragment){e.update(),o(e.before_update);const n=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,n),e.after_update.forEach(x)}}const I=new Set;let C;function z(e,n){e&&e.i&&(I.delete(e),e.i(n))}function T(e,n,t,o){if(e&&e.o){if(I.has(e))return;I.add(e),C.c.push((()=>{I.delete(e),o&&(t&&e.d(1),o())})),e.o(n)}}function O(e,t,i){const{fragment:s,on_mount:a,on_destroy:c,after_update:l}=e.$$;s&&s.m(t,i),x((()=>{const t=a.map(n).filter(r);c?c.push(...t):o(t),e.$$.on_mount=[]})),l.forEach(x)}function U(e,n){const t=e.$$;null!==t.fragment&&(o(t.on_destroy),t.fragment&&t.fragment.d(n),t.on_destroy=t.fragment=null,t.ctx=[])}function A(e,n){-1===e.$$.dirty[0]&&(w.push(e),k||(k=!0,$.then(M)),e.$$.dirty.fill(0)),e.$$.dirty[n/31|0]|=1<<n%31}function L(n,r,i,s,a,l,d=[-1]){const u=h;m(n);const p=r.props||{},f=n.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:t(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:t(),dirty:d,skip_bound:!1};let g=!1;if(f.ctx=i?i(n,p,((e,t,...o)=>{const r=o.length?o[0]:t;return f.ctx&&a(f.ctx[e],f.ctx[e]=r)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](r),g&&A(n,e)),t})):[],f.update(),g=!0,o(f.before_update),f.fragment=!!s&&s(f.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);f.fragment&&f.fragment.l(e),e.forEach(c)}else f.fragment&&f.fragment.c();r.intro&&z(n.$$.fragment),O(n,r.target,r.anchor),M()}m(u)}class R{$destroy(){U(this,1),this.$destroy=e}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(e){var n;this.$$set&&(n=e,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var S=[{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"interactiveConfURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0}];async function F(){Web3&&"1.3.0"===Web3.version||await async function(){return new Promise(((e,n)=>{const t="https://cdnjs.cloudflare.com/ajax/libs/web3/1.3.0/web3.min.js",o=document.createElement("script");o.onload=e,o.onerror=n,o.src=t,document.body.appendChild(o)}))}();const e=await function({mustBeMetaMask:e=!1,silent:n=!1,timeout:t=3e3}={}){!function(){if("boolean"!=typeof e)throw new Error("@metamask/detect-provider: Expected option 'mustBeMetaMask' to be a boolean.");if("boolean"!=typeof n)throw new Error("@metamask/detect-provider: Expected option 'silent' to be a boolean.");if("number"!=typeof t)throw new Error("@metamask/detect-provider: Expected option 'timeout' to be a number.")}();let o=!1;return new Promise((r=>{function i(){if(o)return;o=!0,window.removeEventListener("ethereum#initialized",i);const{ethereum:t}=window;if(!t||e&&!t.isMetaMask){const o=e&&t?"Non-MetaMask window.ethereum detected.":"Unable to detect window.ethereum.";!n&&console.error("@metamask/detect-provider:",o),r(null)}else r(t)}window.ethereum?i():(window.addEventListener("ethereum#initialized",i,{once:!0}),setTimeout((()=>{i()}),t))}))}();if(e){return{web3:new Web3(e),provider:e}}throw new Error("\n\t\t\tNo ethereum provider detected.\n\t\t\tPlease install Metamask or any other wallet (Polaris, Trust Wallet...).\n\t\t")}const P={mainnet:1,ropsten:3,rinkeby:4,goerli:5,kovan:42};function J(e){let n="Unknown";return Object.keys(P).forEach((t=>{P[t]===e&&(n=t)})),n}class W{constructor(e,n,t){this.address=e,this.tokenId=n,this.chainId=t,this.web3,this.provider}async connect(){const e=await F();this.web3=e.web3,this.provider=e.provider,this.provider.on("chainChanged",(e=>{window.location.reload()}));let n=await this.web3.eth.net.getId();if(n!==this.chainId)throw new Error(`Connected to the wrong network. Current{${n}:${J(n)}}; Expected{${this.chainId}:${J(this.chainId)}}`);this.instance=await async function(e,n){return new e.eth.Contract(S,n)}(this.web3,this.address)}async uris(){try{const e=await this.tokenURI();let n="";try{n=await this.interactiveConfURI()}catch(e){}return{tokenURI:e,interactiveConfURI:n}}catch(e){console.log(e)}}async tokenURI(){return this.instance.methods.tokenURI(this.tokenId).call()}async interactiveConfURI(){return this.instance.methods.interactiveConfURI(this.tokenId).call()}}function B(){}function D(e){return e()}function K(){return Object.create(null)}function Y(e){e.forEach(D)}function q(e){return"function"==typeof e}function H(e,n){return e!=e?n==n:e!==n||e&&"object"==typeof e||"function"==typeof e}function G(e,n){e.appendChild(n)}function Q(e,n,t){e.insertBefore(n,t||null)}function V(e){e.parentNode.removeChild(e)}function X(e){return document.createElement(e)}function Z(e){return document.createTextNode(e)}function ee(e,n,t){null==t?e.removeAttribute(n):e.getAttribute(n)!==t&&e.setAttribute(n,t)}function ne(e,n,t){e.classList[t?"add":"remove"](n)}let te;function oe(e){te=e}function re(){if(!te)throw new Error("Function called outside component initialization");return te}function ie(e){re().$$.on_mount.push(e)}function se(){const e=re();return(n,t)=>{const o=e.$$.callbacks[n];if(o){const r=function(e,n){const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,n),t}(n,t);o.slice().forEach((n=>{n.call(e,r)}))}}}function ae(e,n){const t=e.$$.callbacks[n.type];t&&t.slice().forEach((e=>e(n)))}const ce=[],le=[],de=[],ue=[],pe=Promise.resolve();let fe=!1;function he(e){de.push(e)}let me=!1;const ge=new Set;function _e(){if(!me){me=!0;do{for(let e=0;e<ce.length;e+=1){const n=ce[e];oe(n),we(n.$$)}for(oe(null),ce.length=0;le.length;)le.pop()();for(let e=0;e<de.length;e+=1){const n=de[e];ge.has(n)||(ge.add(n),n())}de.length=0}while(ce.length);for(;ue.length;)ue.pop()();fe=!1,me=!1,ge.clear()}}function we(e){if(null!==e.fragment){e.update(),Y(e.before_update);const n=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,n),e.after_update.forEach(he)}}const be=new Set;let ye;function ve(e,n){e&&e.i&&(be.delete(e),e.i(n))}function $e(e,n,t,o){if(e&&e.o){if(be.has(e))return;be.add(e),ye.c.push((()=>{be.delete(e),o&&(t&&e.d(1),o())})),e.o(n)}}function ke(e,n,t){const{fragment:o,on_mount:r,on_destroy:i,after_update:s}=e.$$;o&&o.m(n,t),he((()=>{const n=r.map(D).filter(q);i?i.push(...n):Y(n),e.$$.on_mount=[]})),s.forEach(he)}function xe(e,n){const t=e.$$;null!==t.fragment&&(Y(t.on_destroy),t.fragment&&t.fragment.d(n),t.on_destroy=t.fragment=null,t.ctx=[])}function Ee(e,n,t,o,r,i,s=[-1]){const a=te;oe(e);const c=n.props||{},l=e.$$={fragment:null,ctx:null,props:i,update:B,not_equal:r,bound:K(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:K(),dirty:s,skip_bound:!1};let d=!1;if(l.ctx=t?t(e,c,((n,t,...o)=>{const i=o.length?o[0]:t;return l.ctx&&r(l.ctx[n],l.ctx[n]=i)&&(!l.skip_bound&&l.bound[n]&&l.bound[n](i),d&&function(e,n){-1===e.$$.dirty[0]&&(ce.push(e),fe||(fe=!0,pe.then(_e)),e.$$.dirty.fill(0)),e.$$.dirty[n/31|0]|=1<<n%31}(e,n)),t})):[],l.update(),d=!0,Y(l.before_update),l.fragment=!!o&&o(l.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);l.fragment&&l.fragment.l(e),e.forEach(V)}else l.fragment&&l.fragment.c();n.intro&&ve(e.$$.fragment),ke(e,n.target,n.anchor),_e()}oe(a)}class je{$destroy(){xe(this,1),this.$destroy=B}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(e){var n;this.$$set&&(n=e,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}let Me=1;function Ne(e){let n=e.action,t=e.cmd_id,o=this.pending_cmds.get(t);if(o){if(this.pending_cmds.delete(t),"cmd_error"===n){let{message:n,stack:t}=e,r=new Error(n);r.stack=t,o.reject(r)}"cmd_ok"===n&&o.resolve(e.args||"ok")}else console.error("command not found",t,e,[...this.pending_cmds.keys()])}function Ie(e){if(e.source!==this.iframe.contentWindow)return;const{action:n,args:t}=e.data;switch(n){case"cmd_error":case"cmd_ok":return Ne.call(this,e.data);case"fetch_progress":return this.handlers.on_fetch_progress(t.remaining);case"error":return this.handlers.on_error(e.data);case"unhandledrejection":return this.handlers.on_unhandled_rejection(e.data);case"console":return this.handlers.on_console(e.data);case"console_group":return this.handlers.on_console_group(e.data);case"console_group_collapsed":return this.handlers.on_console_group_collapsed(e.data);case"console_group_end":return this.handlers.on_console_group_end(e.data);default:const o="on_"+n;"function"==typeof this.handlers[o]&&this.handlers[o](e.data)}}class Ce{constructor(e,n){this.iframe=e,this.handlers=n,this.pending_cmds=new Map,this.handle_event=Ie.bind(this),window.addEventListener("message",this.handle_event,!1)}destroy(){window.removeEventListener("message",this.handle_event)}iframe_command(e,n){return new Promise(((t,o)=>{const r=Me++;this.pending_cmds.set(r,{resolve:t,reject:o}),this.iframe.contentWindow.postMessage({action:e,cmd_id:r,args:n},"*")}))}size(){return this.iframe_command("size")}eval(e){return this.iframe_command("eval",{script:e})}add_script(e){return this.iframe_command("add_script",e)}add_script_content(e){return this.iframe_command("add_script_content",e)}add_style(e){return this.iframe_command("add_style",e)}add_asset(e){return this.iframe_command("add_asset",e)}handle_links(){return this.iframe_command("catch_clicks",{})}}function ze(e){let n;return{c(){n=X("strong"),n.innerHTML="<em>Sorry, an error occured while executing the NFT.</em>",ee(n,"class","beyondnft__sandbox__error svelte-uaiew6")},m(e,t){Q(e,n,t)},d(e){e&&V(n)}}}function Te(e){let n,t,o,r,i,s=e[3]&&ze();return{c(){n=X("div"),t=X("iframe"),i=Z(" "),s&&s.c(),ee(t,"title","Sandbox"),ee(t,"sandbox",o="allow-scripts allow-pointer-lock allow-popups "+e[0]),ee(t,"srcdoc",r=e[4]("<!DOCTYPE html>\n<html>\n  <head>\n    <style>\n      \n    </style>\n\n    <script>\n      (function () {\n        const local_eval = eval;\n        eval = function () {};\n\n        function handle_message(ev) {\n          let { action, cmd_id } = ev.data;\n          const send_message = (payload) =>\n            parent.postMessage({ ...payload }, ev.origin);\n\n          const send_reply = (payload) => send_message({ ...payload, cmd_id });\n          const send_ok = (args) => send_reply({ action: 'cmd_ok', args });\n          const send_error = (message, stack) =>\n            send_reply({ action: 'cmd_error', message, stack });\n\n          if (action === 'size') {\n            send_ok({\n              width: document.body.offsetWidth,\n              height: document.body.offsetHeight,\n            });\n          }\n\n          if (action === 'eval') {\n            try {\n              const { script } = ev.data.args;\n              local_eval(script);\n              send_ok();\n            } catch (e) {\n              send_error(e.message, e.stack);\n            }\n          }\n\n          if (action === 'add_script') {\n            try {\n              const script = document.createElement('script');\n              script.src = ev.data.args;\n              script.onload = () => send_ok();\n              document.body.appendChild(script);\n            } catch (e) {\n              send_error(e.message, e.stack);\n            }\n          }\n\n          if (action === 'add_script_content') {\n            try {\n              const script = document.createElement('script');\n              script.text = ev.data.args;\n              script.type = 'text/javascript';\n              document.body.appendChild(script);\n              send_ok();\n            } catch (e) {\n              send_error(e.message, e.stack);\n            }\n          }\n\n          if (action === 'add_style') {\n            try {\n              const link = document.createElement('link');\n              link.rel = 'stylesheet';\n              link.href = ev.data.args;\n              link.onload = () => send_ok();\n              document.body.appendChild(link);\n            } catch (e) {\n              send_error(e.message, e.stack);\n            }\n          }\n\n          if (action === 'catch_clicks') {\n            try {\n              const top_origin = ev.origin;\n              document.body.addEventListener('click', (event) => {\n                if (event.which !== 1) return;\n                if (event.metaKey || event.ctrlKey || event.shiftKey) return;\n                if (event.defaultPrevented) return;\n\n                // ensure target is a link\n                let el = event.target;\n                while (el && el.nodeName !== 'A') el = el.parentNode;\n                if (!el || el.nodeName !== 'A') return;\n\n                if (\n                  el.hasAttribute('download') ||\n                  el.getAttribute('rel') === 'external' ||\n                  el.target\n                )\n                  return;\n\n                event.preventDefault();\n\n                if (el.href.startsWith(top_origin)) {\n                  const url = new URL(el.href);\n                  if (url.hash[0] === '#') {\n                    window.location.hash = url.hash;\n                    return;\n                  }\n                }\n\n                window.open(el.href, '_blank');\n              });\n              send_ok();\n            } catch (e) {\n              send_error(e.message, e.stack);\n            }\n          }\n        }\n\n        window.addEventListener('message', handle_message, false);\n\n        window.onerror = function (msg, url, lineNo, columnNo, error) {\n          try {\n            parent.postMessage({ action: 'error', value: error }, '*');\n          } catch (e) {\n            parent.postMessage({ action: 'error', value: msg }, '*');\n            parent.postMessage({ action: 'error', value: error }, '*');\n          }\n        };\n\n        window.addEventListener('unhandledrejection', (event) => {\n          parent.postMessage(\n            { action: 'unhandledrejection', value: event.reason },\n            '*'\n          );\n        });\n\n        let previous = { level: null, args: null };\n\n        ['clear', 'log', 'info', 'dir', 'warn', 'error', 'table'].forEach(\n          (level) => {\n            const original = console[level];\n            console[level] = (...args) => {\n              const stringifiedArgs = stringify(args);\n              if (\n                previous.level === level &&\n                previous.args &&\n                previous.args === stringifiedArgs\n              ) {\n                parent.postMessage(\n                  { action: 'console', level, duplicate: true },\n                  '*'\n                );\n              } else {\n                previous = { level, args: stringifiedArgs };\n\n                try {\n                  parent.postMessage({ action: 'console', level, args }, '*');\n                } catch (err) {\n                  parent.postMessage(\n                    { action: 'console', level: 'unclonable' },\n                    '*'\n                  );\n                }\n              }\n\n              original(...args);\n            };\n          }\n        );\n\n        [\n          { method: 'group', action: 'console_group' },\n          { method: 'groupEnd', action: 'console_group_end' },\n          { method: 'groupCollapsed', action: 'console_group_collapsed' },\n        ].forEach((group_action) => {\n          const original = console[group_action.method];\n          console[group_action.method] = (label) => {\n            parent.postMessage({ action: group_action.action, label }, '*');\n\n            original(label);\n          };\n        });\n\n        const timers = new Map();\n        const original_time = console.time;\n        const original_timelog = console.timeLog;\n        const original_timeend = console.timeEnd;\n\n        console.time = (label = 'default') => {\n          original_time(label);\n          timers.set(label, performance.now());\n        };\n        console.timeLog = (label = 'default') => {\n          original_timelog(label);\n          const now = performance.now();\n          if (timers.has(label)) {\n            parent.postMessage(\n              {\n                action: 'console',\n                level: 'system-log',\n                args: [`${label}: ${now - timers.get(label)}ms`],\n              },\n              '*'\n            );\n          } else {\n            parent.postMessage(\n              {\n                action: 'console',\n                level: 'system-warn',\n                args: [`Timer '${label}' does not exist`],\n              },\n              '*'\n            );\n          }\n        };\n        console.timeEnd = (label = 'default') => {\n          original_timeend(label);\n          const now = performance.now();\n          if (timers.has(label)) {\n            parent.postMessage(\n              {\n                action: 'console',\n                level: 'system-log',\n                args: [`${label}: ${now - timers.get(label)}ms`],\n              },\n              '*'\n            );\n          } else {\n            parent.postMessage(\n              {\n                action: 'console',\n                level: 'system-warn',\n                args: [`Timer '${label}' does not exist`],\n              },\n              '*'\n            );\n          }\n          timers.delete(label);\n        };\n\n        const original_assert = console.assert;\n        console.assert = (condition, ...args) => {\n          if (condition) {\n            const stack = new Error().stack;\n            parent.postMessage(\n              { action: 'console', level: 'assert', args, stack },\n              '*'\n            );\n          }\n          original_assert(condition, ...args);\n        };\n\n        const counter = new Map();\n        const original_count = console.count;\n        const original_countreset = console.countReset;\n\n        console.count = (label = 'default') => {\n          counter.set(label, (counter.get(label) || 0) + 1);\n          parent.postMessage(\n            {\n              action: 'console',\n              level: 'system-log',\n              args: `${label}: ${counter.get(label)}`,\n            },\n            '*'\n          );\n          original_count(label);\n        };\n\n        console.countReset = (label = 'default') => {\n          if (counter.has(label)) {\n            counter.set(label, 0);\n          } else {\n            parent.postMessage(\n              {\n                action: 'console',\n                level: 'system-warn',\n                args: `Count for '${label}' does not exist`,\n              },\n              '*'\n            );\n          }\n          original_countreset(label);\n        };\n\n        const original_trace = console.trace;\n\n        console.trace = (...args) => {\n          const stack = new Error().stack;\n          parent.postMessage(\n            { action: 'console', level: 'trace', args, stack },\n            '*'\n          );\n          original_trace(...args);\n        };\n\n        function stringify(args) {\n          try {\n            return JSON.stringify(args);\n          } catch (error) {\n            return null;\n          }\n        }\n      })(this);\n\n      // remove alert, set window context\n      (() => {\n        const original_alert = window.alert;\n        window.alert = function () {};\n\n        window.context = {\n          nft_json: {},\n          config: {},\n          owner: '0x0000000000000000000000000000000000000000',\n        };\n      })(this);\n    <\/script>\n    <style>\n      body,\n      html {\n        padding: 0;\n        margin: 0;\n        min-width: 100%;\n        min-height: 100%;\n      }\n\n      body {\n        position: absolute;\n        top: 0;\n        left: 0;\n      }\n    </style>\n  </head>\n  <body>\n    \x3c!-- NFTCODE --\x3e\n  </body>\n</html>\n")),ee(t,"class","svelte-uaiew6"),ne(t,"greyed-out",e[3]||Oe||e[2]),ee(n,"class","beyondnft__sandbox svelte-uaiew6")},m(o,r){Q(o,n,r),G(n,t),e[10](t),G(n,i),s&&s.m(n,null)},p(e,[r]){1&r&&o!==(o="allow-scripts allow-pointer-lock allow-popups "+e[0])&&ee(t,"sandbox",o),12&r&&ne(t,"greyed-out",e[3]||Oe||e[2]),e[3]?s||(s=ze(),s.c(),s.m(n,null)):s&&(s.d(1),s=null)},i:B,o:B,d(t){t&&V(n),e[10](null),s&&s.d()}}}let Oe=!1;function Ue(e,n,t){let{code:o=""}=n,{proxy:r}=n,{json:i}=n,{owner_properties:s}=n,{owner:a}=n,{sandbox_props:c=""}=n;const l=se();let d,u,p,f=0,h=[],m=[],g=h;function _(e){t(3,u=e),l("error",e)}function w(e){g.push(p=e),h=h}function b(e,n){const t={level:"group",label:e,collapsed:n,logs:[]};g.push(t),m.push(g),g=t.logs,h=h}return ie((()=>(t(5,r=new Ce(d,{on_fetch_progress:e=>{t(2,f=e)},on_error:e=>{w({level:"error",args:[e.value]}),_(e.value)},on_unhandled_rejection:e=>{let n=e.value;"string"==typeof n&&(n={message:n}),n.message="Uncaught (in promise): "+n.message,w({level:"error",args:[n]}),_(n)},on_console:e=>{"clear"===e.level?(g=h=[],w(e)):e.duplicate?function(){const e=g[g.length-1];e?(e.count=(e.count||1)+1,h=h):(p.count=1,w(p))}():w(e)},on_console_group:e=>{b(e.label,!1)},on_console_group_end:()=>{g=m.pop()},on_console_group_collapsed:e=>{b(e.label,!0)}})),d.addEventListener("load",(()=>{r.handle_links(),!u&&l("loaded")})),()=>{r.destroy()}))),e.$$set=e=>{"code"in e&&t(6,o=e.code),"proxy"in e&&t(5,r=e.proxy),"json"in e&&t(7,i=e.json),"owner_properties"in e&&t(8,s=e.owner_properties),"owner"in e&&t(9,a=e.owner),"sandbox_props"in e&&t(0,c=e.sandbox_props)},[c,d,f,u,function(e){let n=i.interactive_nft?function(e){let n="";if(Array.isArray(e))for(const t of e){const e=t.type;"script"===e?n+=`<script type="text/javascript" src="${t.url}"><\/script>`:"style"===e?n+=`<script type="text/javascript">\n\t\t\t\t\t\t(() => {\n\t\t\t\t\t\t\tconst link = document.createElement('link');\n\t\t\t\t\t\t\tlink.rel = 'stylesheet';\n\t\t\t\t\t\t\tlink.href = "${t.url}";\n\t\t\t\t\t\t\tdocument.body.appendChild(link);\n\t\t\t\t\t\t})()\n\t\t\t\t\t<\/script>`:console.log("Unknown dependency type "+e)}return n}(i.interactive_nft.dependencies):"";const t=function(){const e={};if(i.interactive_nft&&Array.isArray(i.interactive_nft.properties)){let n={};s&&"object"==typeof s&&(n=s);for(const t of i.interactive_nft.properties)e[t.name]=t.value,void 0!==n[t.name]&&(e[t.name]=n[t.name])}return e}();return n+=`<script type="text/javascript">\n      // specific p5 because it's causing troubles.\n      if (typeof p5 !== 'undefined' && p5.disableFriendlyErrors) {\n        p5.disableFriendlyErrors = true;\n        new p5();\n      }\n\n      ${`\n      window.context.properties = JSON.parse('${JSON.stringify(t)}');\n    `}\n      ${`\n      window.context.nft_json = JSON.parse(${JSON.stringify(JSON.stringify(i))});\n    `}\n      ${`window.context.owner = ${JSON.stringify(a)};`}\n    <\/script>`,n+=o,e.replace("\x3c!-- NFTCODE --\x3e",n)},r,o,i,s,a,function(e){le[e?"unshift":"push"]((()=>{d=e,t(1,d)}))}]}class Ae extends je{constructor(e){var n;super(),document.getElementById("svelte-uaiew6-style")||((n=X("style")).id="svelte-uaiew6-style",n.textContent=".beyondnft__sandbox.svelte-uaiew6{background-color:white;border:none;width:100%;height:100%;position:relative}iframe.svelte-uaiew6{min-width:100%;min-height:100%;border:none;display:block}.greyed-out.svelte-uaiew6{filter:grayscale(50%) blur(1px);opacity:0.25}.beyondnft__sandbox__error.svelte-uaiew6{font-size:0.9em;position:absolute;top:0;left:0;padding:5px}",G(document.head,n)),Ee(this,e,Ue,Te,H,{code:6,proxy:5,json:7,owner_properties:8,owner:9,sandbox_props:0})}}function Le(e){let n;return{c(){n=Z("Loading...")},m(e,t){Q(e,n,t)},p:B,i:B,o:B,d(e){e&&V(n)}}}function Re(e){let n,t,o;function r(n){e[8].call(null,n)}let i={code:e[1],owner_properties:e[2],sandbox_props:e[4],owner:e[3],json:e[0]};return void 0!==e[5]&&(i.proxy=e[5]),n=new Ae({props:i}),le.push((()=>function(e,n,t){const o=e.$$.props.proxy;void 0!==o&&(e.$$.bound[o]=t,t(e.$$.ctx[o]))}(n,0,r))),n.$on("loaded",e[9]),n.$on("error",e[10]),n.$on("warning",e[11]),{c(){var e;(e=n.$$.fragment)&&e.c()},m(e,t){ke(n,e,t),o=!0},p(e,o){const r={};var i;2&o&&(r.code=e[1]),4&o&&(r.owner_properties=e[2]),16&o&&(r.sandbox_props=e[4]),8&o&&(r.owner=e[3]),1&o&&(r.json=e[0]),!t&&32&o&&(t=!0,r.proxy=e[5],i=()=>t=!1,ue.push(i)),n.$set(r)},i(e){o||(ve(n.$$.fragment,e),o=!0)},o(e){$e(n.$$.fragment,e),o=!1},d(e){xe(n,e)}}}function Se(e){let n,t,o,r;const i=[Re,Le],s=[];function a(e,n){return e[1]?0:1}return n=a(e),t=s[n]=i[n](e),{c(){t.c(),o=Z("")},m(e,t){s[n].m(e,t),Q(e,o,t),r=!0},p(e,[r]){let c=n;n=a(e),n===c?s[n].p(e,r):(ye={r:0,c:[],p:ye},$e(s[c],1,1,(()=>{s[c]=null})),ye.r||Y(ye.c),ye=ye.p,t=s[n],t||(t=s[n]=i[n](e),t.c()),ve(t,1),t.m(o.parentNode,o))},i(e){r||(ve(t),r=!0)},o(e){$e(t),r=!1},d(e){s[n].d(e),e&&V(o)}}}function Fe(e,n,t){const o=se();let{data:r={}}=n,{code:i=""}=n,{owner_properties:s={}}=n,{owner:a="0x0000000000000000000000000000000000000000"}=n,{sandbox_props:c=""}=n,l=null;return ie((async()=>{"string"==typeof r&&await fetch(r).then((e=>e.json())).then((e=>t(0,r=e))).catch((e=>{o("warning",new Error("Error while fetching NFT's JSON at "+r)),t(0,r=null)})),r?(s&&"string"==typeof s&&await fetch(s).then((e=>e.json())).then((e=>t(2,s=e))).catch((e=>{o("warning",`Error while fetching owner_properties on ${s}.\n            Setting owner_properties to default.`),t(2,s={})})),!i&&r.interactive_nft&&(r.interactive_nft.code?(t(1,i=r.interactive_nft.code),t(0,r.interactive_nft.code=null,r)):r.interactive_nft.code_uri&&await fetch(r.interactive_nft.code_uri).then((e=>e.text())).then((e=>t(1,i=e))).catch((e=>{o("Error",new Error("Error while fetching "+r.interactive_nft.code_uri))}))),i||o("Error",new Error("You need to provide code for this NFT to run"))):o("error",new Error("You need to provide a data property.\n      Either a valid uri to the NFT JSON or the parsed NFT JSON."))})),e.$$set=e=>{"data"in e&&t(0,r=e.data),"code"in e&&t(1,i=e.code),"owner_properties"in e&&t(2,s=e.owner_properties),"owner"in e&&t(3,a=e.owner),"sandbox_props"in e&&t(4,c=e.sandbox_props)},[r,i,s,a,c,l,"0.0.5",function(){return l},function(e){l=e,t(5,l)},function(n){ae(e,n)},function(n){ae(e,n)},function(n){ae(e,n)}]}class Pe extends je{constructor(e){super(),Ee(this,e,Fe,Se,H,{data:0,code:1,owner_properties:2,owner:3,sandbox_props:4,version:6,getProxy:7})}get version(){return this.$$.ctx[6]}get getProxy(){return this.$$.ctx[7]}}function Je(e){let n,t;function o(e,n){return e[2].interactive_nft?De:Be}let r=o(e),i=r(e);return{c(){n=l("div"),i.c(),p(n,"class","beyondembeddable__wrapper svelte-1jcikcp"),p(n,"style",t=`width: ${e[4]}; height: ${e[5]}`),f(n,"resizable",e[0])},m(e,t){a(e,n,t),i.m(n,null)},p(e,s){r===(r=o(e))&&i?i.p(e,s):(i.d(1),i=r(e),i&&(i.c(),i.m(n,null))),48&s&&t!==(t=`width: ${e[4]}; height: ${e[5]}`)&&p(n,"style",t),1&s&&f(n,"resizable",e[0])},d(e){e&&c(n),i.d()}}}function We(n){let t;return{c(){t=d("Loading...")},m(e,n){a(e,t,n)},p:e,d(e){e&&c(t)}}}function Be(e){let n,t,o;return{c(){n=l("img"),p(n,"class","beyondembeddable__fallback svelte-1jcikcp"),n.src!==(t=e[2].image.replace("ipfs://","https://gateway.ipfs.io/"))&&p(n,"src",t),p(n,"alt",o=e[2].name)},m(e,t){a(e,n,t)},p(e,r){4&r&&n.src!==(t=e[2].image.replace("ipfs://","https://gateway.ipfs.io/"))&&p(n,"src",t),4&r&&o!==(o=e[2].name)&&p(n,"alt",o)},d(e){e&&c(n)}}}function De(e){let n,t,o,r=e[0]&&Ke(e);return{c(){n=l("div"),t=d(" "),r&&r.c(),o=u(),p(n,"class","beyondembeddable__sandbox svelte-1jcikcp")},m(i,s){a(i,n,s),e[11](n),a(i,t,s),r&&r.m(i,s),a(i,o,s)},p(e,n){e[0]?r?r.p(e,n):(r=Ke(e),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d(i){i&&c(n),e[11](null),i&&c(t),r&&r.d(i),i&&c(o)}}}function Ke(n){let t,o,r;return{c(){t=l("em"),t.textContent="toggle size",p(t,"class","svelte-1jcikcp")},m(e,i){var s,c,l,d;a(e,t,i),o||(s=t,c="click",l=n[6],s.addEventListener(c,l,d),r=()=>s.removeEventListener(c,l,d),o=!0)},p:e,d(e){e&&c(t),o=!1,r()}}}function Ye(n){let t;function o(e,n){return e[1]?Je:We}let r=o(n),i=r(n);return{c(){i.c(),t=u()},m(e,n){i.m(e,n),a(e,t,n)},p(e,[n]){r===(r=o(e))&&i?i.p(e,n):(i.d(1),i=r(e),i&&(i.c(),i.m(t.parentNode,t)))},i:e,o:e,d(e){i.d(e),e&&c(t)}}}function qe(e,n,t){let{owner:o}=n,{uris:r}=n,{resizable:i}=n,{width:s}=n,{height:a}=n;const c=_();let l,d,u,p,f,h=!1,m={},w=s,y=a;function v(){let e=Math.floor(100*parseInt(s)/u.width)/100;t(3,d.style.transform=`scale(${e}, ${e})`,d)}var $;return $=async()=>{try{let e;r.tokenURI&&(e=await fetch(r.tokenURI),t(2,l=await e.json())),r.interactiveConfURI&&(e=await fetch(r.interactiveConfURI),m=await e.json()),t(1,h=!0)}catch(e){c("error","Error while loading NFT JSONs.")}},g().$$.on_mount.push($),e.$$set=e=>{"owner"in e&&t(7,o=e.owner),"uris"in e&&t(8,r=e.uris),"resizable"in e&&t(0,i=e.resizable),"width"in e&&t(9,s=e.width),"height"in e&&t(10,a=e.height)},e.$$.update=()=>{32782&e.$$.dirty&&h&&d&&l.interactive_nft&&!f&&function(){const e={data:l};o&&(e.owner=o),m&&(e.owner_properties=m),t(15,f=new Pe({target:d,props:e})),f.$on("loaded",(async e=>{i&&(p=f.getProxy(),u=await p.size(),p.iframe.width=u.width,p.iframe.height=u.height,v()),c("loaded",{size:u})})),f.$on("error",(e=>{c("error",e.detail)}))}()},[i,h,l,d,w,y,function(){t(3,d.style.transform="",d),w===s?(t(4,w=u.width+"px"),t(5,y=u.height+"px")):(t(4,w=s),t(5,y=a),v())},o,r,s,a,function(e){b[e?"unshift":"push"]((()=>{d=e,t(3,d)}))}]}class He extends R{constructor(e){var n;super(),document.getElementById("svelte-1jcikcp-style")||((n=l("style")).id="svelte-1jcikcp-style",n.textContent=".beyondembeddable__wrapper.resizable.svelte-1jcikcp.svelte-1jcikcp{position:relative}em.svelte-1jcikcp.svelte-1jcikcp{position:absolute;top:100%;font-size:0.8em;right:0;z-index:0}.beyondembeddable__sandbox.svelte-1jcikcp.svelte-1jcikcp{width:100%;height:100%;transform-origin:top left}.beyondembeddable__wrapper.resizable.svelte-1jcikcp .beyondembeddable__sandbox.svelte-1jcikcp{position:absolute;top:0;left:0;right:0;bottom:0;min-width:100%;min-height:100%;z-index:1}img.svelte-1jcikcp.svelte-1jcikcp{width:100%;height:auto}em.svelte-1jcikcp.svelte-1jcikcp{cursor:pointer}",s(document.head,n)),L(this,e,qe,Ye,i,{owner:7,uris:8,resizable:0,width:9,height:10})}}function Ge(e){let n,t;return n=new He({props:{owner:e[0],uris:e[6],resizable:e[1],width:e[2],height:e[3]}}),n.$on("loaded",e[11]),n.$on("error",e[12]),{c(){var e;(e=n.$$.fragment)&&e.c()},m(e,o){O(n,e,o),t=!0},p(e,t){const o={};1&t&&(o.owner=e[0]),64&t&&(o.uris=e[6]),2&t&&(o.resizable=e[1]),4&t&&(o.width=e[2]),8&t&&(o.height=e[3]),n.$set(o)},i(e){t||(z(n.$$.fragment,e),t=!0)},o(e){T(n.$$.fragment,e),t=!1},d(e){U(n,e)}}}function Qe(n){let t,o;return{c(){t=l("p"),o=d(n[5]),p(t,"class","beyondembeddable__error")},m(e,n){a(e,t,n),s(t,o)},p(e,n){32&n&&function(e,n){n=""+n,e.wholeText!==n&&(e.data=n)}(o,e[5])},i:e,o:e,d(e){e&&c(t)}}}function Ve(e){let n,t,r,i;const s=[Qe,Ge],d=[];function u(e,n){return e[5]?0:e[4]?1:-1}return~(t=u(e))&&(r=d[t]=s[t](e)),{c(){n=l("div"),r&&r.c(),p(n,"class","beyondembeddable")},m(e,o){a(e,n,o),~t&&d[t].m(n,null),i=!0},p(e,[i]){let a=t;t=u(e),t===a?~t&&d[t].p(e,i):(r&&(C={r:0,c:[],p:C},T(d[a],1,1,(()=>{d[a]=null})),C.r||o(C.c),C=C.p),~t?(r=d[t],r||(r=d[t]=s[t](e),r.c()),z(r,1),r.m(n,null)):r=null)},i(e){i||(z(r),i=!0)},o(e){T(r),i=!1},d(e){e&&c(n),~t&&d[t].d()}}}function Xe(e,n,t){let{contract:o}=n,{tokenId:r=null}=n,{owner:i=null}=n,{network:s=P.mainnet}=n,{resizable:a=!0}=n,{width:c="388px"}=n,{height:l="560px"}=n;let d=P.mainnet;d="string"==typeof s&&P[s]?P[s]:parseInt(s);let u,p,f,h=!1;return e.$$set=e=>{"contract"in e&&t(7,o=e.contract),"tokenId"in e&&t(8,r=e.tokenId),"owner"in e&&t(0,i=e.owner),"network"in e&&t(9,s=e.network),"resizable"in e&&t(1,a=e.resizable),"width"in e&&t(2,c=e.width),"height"in e&&t(3,l=e.height)},e.$$.update=()=>{448&e.$$.dirty&&o&&null!==r&&(f?f.tokenURI&&t(4,h=!0):async function(){try{p=new W(o,r,d),await p.connect(),t(6,f=await p.uris())}catch(e){t(5,u=e.message)}}())},[i,a,c,l,h,u,f,o,r,s,"0.0.4",function(n){!function(e,n){const t=e.$$.callbacks[n.type];t&&t.slice().forEach((e=>e(n)))}(e,n)},e=>t(5,u=e.detail.message)]}return class extends R{constructor(e){super(),L(this,e,Xe,Ve,i,{contract:7,tokenId:8,owner:0,network:9,resizable:1,width:2,height:3,version:10})}get version(){return this.$$.ctx[10]}}}));
